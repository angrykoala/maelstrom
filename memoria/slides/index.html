<!DOCTYPE html>
<html>
  <head>
    <title>Maelström</title>
    <meta charset="utf-8">
    <style>
      @import url(https://fonts.googleapis.com/css?family=Yanone+Kaffeesatz);
      @import url(https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic);
      @import url(https://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700,400italic);

      body { font-family: 'Droid Serif'; }
      h1, h2, h3 {
        font-family: 'Yanone Kaffeesatz';
        font-weight: normal;
      }
      .remark-code, .remark-inline-code { font-family: 'Ubuntu Mono'; }
    </style>
  </head>
  <body>
    <textarea id="source">

class: center, middle

<img src="images/maelstrom_logo.png" width="40%">
# Maelström   
_Framework para videojuegos multijugador masivo online_   
_**Andrés Ortiz Corrales**_   


???
Agradecimientos

---
layout: true
background-image: url(images/maelstrom-bg.png)

---


## ¿Qué es un MMO?

* **MMO**: _Massively Multiplayer Online (Game)_

<center>
<img src="images/wow.jpg" width="40%"> <img src="images/coc.png" width="40%"><br>  
<i class="footnote">World of Warcraft y Clash of Clans</i>
</center>


???

* Pocos MMO

* Multiplayer: 2~64 jugadores

* MMO: >100

--
count: false

* **Multiplayer vs MMO**

---

## ¿Qué es Maelström?

Prototipo Open-Source de un videojuego **Multijugador Masivo Online** de estrategia comercial
* **GitHub:** <https://github.com/demiurgosoft/maelstrom>
* **Licencia:** GNU AGPL-3.0

<center>
<img src="images/screen1.png" width="80%"></br>
<i class="footnote">Captura de pantalla de Maelström</i>
</center>

???

**Objetivos**   

* Analizar los MMO

* Proponer soluciones  ¿Por qué no hay mas mmo? 

* Desarrollar prototipo (MVP) y analizar viabilidad con tecnología extensible y modernas

* Proponer un framework

---

## Problemas

* Escasa documentación

* Tecnologías antiguas
  * WoW (2004)
  * Ogame (2002)
  * Clash of Clans (2012)

* Sin framework ni tecnología específica

???

Multiplayer=/=mmo 

Comentar latencia

Dificultades técnicas

--


### Requisitos

* Escalable

* Baja latencia

* Gestión de datos complejos


---

## Arquitectura: servidor

<center>
<img src="images/mono-micro.png" width=100%></br>
<i class="footnote">Microservice Architecture, Fowler</i>
</center>

???
**5 MIN**

* Qué son los microservicios   
* Ventajas:
    * Tecnologia específica
    * Escalabilidad
    * Extensibilidad

---

## Arquitectura: servidor

<center>
<img src="images/server_arch.png" width=100%></br>
<i class="footnote">Propuesta inicial de diseño</i>
</center>

???

Buscar mínima latencia

Orientacion a servicios (SOA)

---

## Arquitectura: servidor

<center>
<img src="images/server_arch_2.svg" width=90%></br>
<i class="footnote">Arquitectura del prototipo</i>
</center>

???
Simplificacion en World

Arquitectura actual

Baja latencia

---

## Arquitectura: cliente

* Servidor independiente del cliente
    * Cliente Web
    * Bot
* Comunicación con tecnologías estándar
  * HTTP
  * Websockets

<center>
<img src="images/websocket.png" width="45%"></img>
</center>

???

Asíncrono: El cliente obtiene la información de forma dinámica y la actualiza de forma asíncrona de diversos servidores

Comentar bots

**Websockets vs HTTP**

Publish-subscribe

---

## Planificación y desarrollo

* Metodología ágil
    * Historias de Usuario: 39
    * PH totales: 338
* Horas Totales: 456 horas

<center>
<img src="images/burndown.png" width="64%"></img></br>
</center>

???
**10 min mark**
1.35 horas por PH
\>250 issues
\>20 milestones

Desarrollo basado en XP

---

## Implementación

* **4 Módulos**

<center>
<img src="images/loc.png" width=80%>
</center>

???
Comentar desarrollo: test,prototiping
4 módulos independientes 

LOC (sin comentarios ni lineas blancas)

---

## Implementación: pruebas

* _World_
    * Tests: 32
    * Cobertura: 79%
* _Users_
    * Tests: 14
    * Cobertura: 95%
* _**Total**_
    * Tests: 46
    * Cobertura: 82%

<center>
<img src="images/users_coverage.png" width=100%></br>
<i class="footnote">Análisis de cobertura de Usuarios</i>
</center>

???
Comentar desarrollo
LOC

---

## Implementación: pruebas
<center>
<img src="images/world.png" width=80%></br>
<i class="footnote">Evolución del servicio de mundo</i>
</center>

---

## Tecnología

<img src="images/logos/nodejs.png" height=80></img>
<img src="images/logos/express.png" height=50></img>    
Desarrollo del servidor con _javascript_, **Node.js** y el framework **express**

----------

<img src="images/logos/mongodb.png" height=120></img>
<img src="images/logos/mongoose.png" height=90></img>  
Base de datos principal con **MongoDB** y **mongoose**



---

## Tecnología

    
<img src="images/logos/react.png" height=90></img>
<img src="images/logos/jquery.gif" height=90></img>
<img src="images/logos/bootstrap.png" height=90></img>    
Cliente desarrollado con **React**, **JQuery** y **Bootstrap**

-------

<img src="images/logos/ajax.png" height=80></img>
<img src="images/logos/socketio.png" height=70></img>
<img src="images/logos/jwt.svg" height=80></img>    
Comunicación cliente-servidor mediante **Ajax**, implementación de _websockets_ con **socket.io** y autentificación con **JSON Web Tokens**

---------

<img src="images/logos/browserify.png" height=90></img>
<img src="images/logos/ejs.png" height=90></img>    
Empaquetamiento del cliente con **browserify** y templating con **ejs**


---

## Tecnología

<img src="images/logos/github.png" width=10%></img>   
Desarrolo abierto en **GitHub**, seguimiento mediante **issues** y **milestones** en cada repositorio

-----

<img src="images/logos/travis.png" width=10%></img>
<img src="images/logos/chai_mocha.png" width=20%></img>
<img src="images/logos/coveralls.png" width=15%></img>
<img src="images/logos/gemnasium.png" width=10%></img>    
Integración continua con **Travis.ci**, tests con **mocha** y **chai**, cobertura con **coveralls**, análisis de dependencias con **gemnasium**

-------
<img src="images/logos/npm.png" width=15%></img>
<img src="images/logos/openshift.png" width=10%></img>
<img src="images/logos/heroku.jpg" width=20%></img>   
Gestión de paquetes y despliegue con **npm**, **openshift** y **heroku**


---
class: center, middle
# Demo

<!--iframe src="http://maelstrom-mmo.herokuapp.com/" width="100%" height=600px></iframe-->

???
http://maelstrom-mmo.herokuapp.com/   

http://maelstromusers-demiurgosoft.rhcloud.com/

http://maelstrom-world.herokuapp.com/   


---
## Conclusión y trabajos futuros

Prototipo MMO:

* Diseño arquitectónico extensible basado en servicios.

* Baja latencia.

* Sistema distribuido.

* Open-source.



???

* Conocimientos Adquiridos

* Asignaturas Relevantes

* Almacenamiento de datos NoSQL (MongoDB)

* Latencia menor de 300ms


---

## Conclusión y trabajos futuros

* Posible Comercialización

* Arquitectura propuesta

<center>
<img src="images/game_arch_3.png" width=80%></br>
</center>

???
Comentar dificultades en escalabilidad

Bases de datos (Redis)

**Comercialización:**

* tipos de modelo de negocio (desarrollo juegos, venta del framework (pequeñas y grandes empresas), proporcionar servicio)
* Riesgo Alto: Gran coste, necesaria inversion inicial de una empresa
* MVP: Este prototipo

---
layout:false
class: center, middle

<img src="images/maelstrom_logo.png" width="40%">

???

Patrones:

* Observer (cliente y servidor)
* Facade (servicios)

* Prototype (Creacion de barcos)
* Singleton (elemento world)

Node vs Python vs PHP

TCP vs UDP

---
count: false

## Json Web Token

<center>
    <img src="images/jwt-diagram.png" width=100%></br>
    <i class="footnote">Diagrama de JWT (auth0)</i>
</center>

???

JWT

* 3 partes (header, payload, signature)
* ID en payload (id comun entre servicios)
* Conexion http y wss con autentificación jwt
* `Bearer <token>`
    
---
count: false

## Sync vs async

<center>
    <img src="images/async.png" width=80%></br>
</center>


---
count: false

## Desarrollo ágil

**Principios basados en XP**

* Historias de usuario

* Desarrollo iterativo

* Funcionalidad mínima

* Prototipado

* Desarrollo de _spikes_

* Refactorización continua

* Desarrollo de tests

* Repositorio común de código

* Integración continua

* Codificación estándar

???

Técnicas basadas en XP

---
count: false

## Maelström

>"Maelstrom, Moskoëstrom, Malstrøm, Mailström o también Moskstraumen es un gran remolino que se halla en las costas meridionales del archipiélago noruego de las islas Lofoten, en la provincia de Nordland"

_Wikipedia_


* Edgar Allan Poe. _"Un descenso al Maelstrom"_

<center>
<img src="images/maelstrom_map.png" width="50%"></br>
<i class="footnote">Carta Marina de Olaus Magnus - Wikipedia</i>
</center>

???

* Usado como sinónimo de _Remolino Gigante_



    </textarea>
    <script src="./remark-latest.min.js">
    </script>
    <script>
      var slideshow = remark.create();
    </script>
  </body>
</html>
